<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>3. Non-uniqueness and discrete circulation · GridPotentialFlow.jl</title><meta name="title" content="3. Non-uniqueness and discrete circulation · GridPotentialFlow.jl"/><meta property="og:title" content="3. Non-uniqueness and discrete circulation · GridPotentialFlow.jl"/><meta property="twitter:title" content="3. Non-uniqueness and discrete circulation · GridPotentialFlow.jl"/><meta name="description" content="Documentation for GridPotentialFlow.jl."/><meta property="og:description" content="Documentation for GridPotentialFlow.jl."/><meta property="twitter:description" content="Documentation for GridPotentialFlow.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">GridPotentialFlow.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../1.-Basic-potential-flow-problem/">1. Basic potential flow problem</a></li><li><a class="tocitem" href="../2.-Potential-flow-with-an-impenetrable-surface/">2. Potential flow with an impenetrable surface</a></li><li class="is-active"><a class="tocitem" href>3. Non-uniqueness and discrete circulation</a></li><li><a class="tocitem" href="../4.-The-Kutta-condition/">4. The Kutta condition</a></li><li><a class="tocitem" href="../5.-Generalized-edge-conditions/">5. Generalized edge conditions</a></li><li><a class="tocitem" href="../6.-Force-and-the-added-mass/">6. Force and the added mass</a></li></ul></li><li><span class="tocitem">Library</span><ul><li><a class="tocitem" href="../../public/">Public Documentation</a></li><li><a class="tocitem" href="../../private/">Private Documentation</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Manual</a></li><li class="is-active"><a href>3. Non-uniqueness and discrete circulation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>3. Non-uniqueness and discrete circulation</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaIBPM/GridPotentialFlow.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaIBPM/GridPotentialFlow.jl/blob/master/test/literate/3.-Non-uniqueness-and-discrete-circulation.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="3.-Non-uniqueness-and-discrete-circulation"><a class="docs-heading-anchor" href="#3.-Non-uniqueness-and-discrete-circulation">3. Non-uniqueness and discrete circulation</a><a id="3.-Non-uniqueness-and-discrete-circulation-1"></a><a class="docs-heading-anchor-permalink" href="#3.-Non-uniqueness-and-discrete-circulation" title="Permalink"></a></h1><p>There is no unique solution to the two-dimensional potential flow problem in the presence of an impenetrable surface, since one can choose any value for the uniform value <span>$\mathfrak{s}_0$</span> and still enforce the no-penetration condition. Equivalently, we can specify any circulation about the body and still enforce this condition. For later use, let us write this uniform surface streamfunction as <span>$\mathfrak{s}_0 = s_0 \mathfrak{1}$</span>, where <span>$s_0$</span> is a single scalar value and <span>$\mathfrak{1}$</span> is a vector of ones on all surface points. The discrete circulation <span>$\Gamma_b$</span> about the body is given by the sum of the bound vortex sheet data and can be written compactly as</p><p class="math-container">\[\Gamma_b = \mathfrak{1}^{T} \mathfrak{f}.\]</p><p>In <code>GridPotentialFlow.jl</code>, the user cannot specify <span>$s_0$</span> directly. Instead, the package solves the system</p><p class="math-container">\[\begin{bmatrix}
\mathsf{L} &amp; \mathsf{R} &amp; 0\\
\mathsf{E} &amp;  0 &amp; \mathfrak{1}\\
0 &amp; \mathfrak{1}^{T} &amp; 0\\
\end{bmatrix} \begin{pmatrix} \mathsf{s} \\ \mathfrak{f} \\ s_0 \end{pmatrix} =
\begin{pmatrix} -\mathsf{w} \\ \mathfrak{s}&#39;_b \\ \Gamma_b \end{pmatrix}.\]</p><p>and the circulation can be specified using the <code>Γ</code> keyword for each body. If it is not specified, it is set to zero. The return value of <code>solvesystem</code> has a field <code>ψ₀</code>, whose entries represent the value for <span>$s_0$</span> for each body, which are in this case the Lagrange multipliers to enforce the specified circulation.</p><p>We now illustrate how to specify the circulation by simulating the flow around two cylinders that have different circulations.</p><pre><code class="language-julia hljs">Δx = 0.01
Lx = 2.0
xlim = (-Lx/2,Lx/2)
ylim = (-Lx/2,Lx/2)
g = PhysicalGrid(xlim,ylim,Δx);</code></pre><p>The two cylinders are positioned using the tools from <code>RigidTransform</code> from <code>RigidBodyTools.jl</code> and the circulation of the first one is set to a non-zero value.</p><pre><code class="language-julia hljs">R = Lx/8;
b_left = PotentialFlowBody(Circle(R,Δx),Γ=1.0)
Xm1 = RigidTransform((-Lx/4,0.0),0.0)
update_body!(b_left,Xm1);
b_right = PotentialFlowBody(Circle(R,Δx))
Xm2 = RigidTransform((Lx/4,0.0),0.0)
update_body!(b_right,Xm2);</code></pre><p>A plot of the streamfunction then clearly shows the non-zero circulation about the left cylinder.</p><pre><code class="language-julia hljs">model = VortexModel(g,bodies=[b_left,b_right])
s = streamfunction(model)
plot(s,g)
plot!(b_left,fillcolor=:black,fillrange=0,fillalpha=0.25,linecolor=:black,linewidth=2)
plot!(b_right,fillcolor=:black,fillrange=0,fillalpha=0.25,linecolor=:black,linewidth=2)</code></pre><img src="1e7a168e.svg" alt="Example block output"/><p>When the previously introduced saddle point system</p><p class="math-container">\[\begin{bmatrix}
\mathsf{L} &amp; \mathsf{R} \\
\mathsf{E} &amp;  0
\end{bmatrix} \begin{pmatrix} \mathsf{s} \\ \mathfrak{f} \end{pmatrix} =
\begin{pmatrix} -\mathsf{w} \\ \mathfrak{s}&#39;_b - \mathfrak{s}_0 \end{pmatrix}.\]</p><p>is solved, the resulting circulation is</p><p class="math-container">\[\Gamma_{b} = \mathfrak{1}^{T} \mathsf{S}^{-1}\left(\mathfrak{s}_{b}^{\prime}+\mathsf{EL}^{-1} \mathsf{w}\right)-s_{0} \mathfrak{1}^{T} \mathsf{S}^{-1} \mathfrak{1},\]</p><p>where <span>$\mathsf{S} = -\mathsf{EL}^{-1}\mathsf{R}$</span> is the Schur complement. The scalar factor <span>$\mathfrak{1}^{T} \mathsf{S}^{-1} \mathfrak{1}$</span> in this expression is a property of the set of points and their immersion into the Cartesian grid. Part of this factor, <span>$\mathsf{S}^{-1} \mathfrak{1}$</span>, represents the bound vortex sheet strength associated with a uniform, unit-strength streamfunction on the surface. This sheet has a particularly important role in some of the discussion to follow, so we will denote its strength by <span>$\mathfrak{f}_0$</span>:</p><p class="math-container">\[\mathfrak{f}_0 \equiv \mathsf{S}^{-1} \mathfrak{1}.\]</p><p>We demonstrate below the distribution of <span>$\mathfrak{f}_0$</span> for elliptical cylinders with different aspect ratios.</p><pre><code class="language-julia hljs">Δx = 0.004
Lx = 2.0
xlim = (-Lx/2,Lx/2)
ylim = (-Lx/2,Lx/2)
g = PhysicalGrid(xlim,ylim,Δx);</code></pre><p>Let us consider four cylinders with aspect ratios 1, 2, 3, and infinity. An ellipse with infinite aspect ratio is a flat plate, so we construct that case separately.</p><pre><code class="language-julia hljs">a = Lx/4 # semi-major axis
AR_list = [1.0,2.0,3.0]
ellipses = [Ellipse(a,a/AR,Δx) for AR in AR_list]
bodies = PotentialFlowBody[]
push!(bodies,[PotentialFlowBody(SplinedBody(hcat(e.x,e.y),3*cellsize(g))) for e in ellipses]...)
push!(bodies,PotentialFlowBody(Plate(2*a,3*Δx)));
colors = [:blue,:red,:green,:black]
plot()
for i in 1:length(bodies)
    plot!(bodies[i],fillrange=0,fillalpha=0.0,linecolor=colors[i],linewidth=2)
end
plot!(xlim=xlim,ylim=ylim,xlabel=&quot;x&quot;,ylabel=&quot;y&quot;)</code></pre><img src="d03c5bd1.svg" alt="Example block output"/><p>To compute <span>$\mathfrak{f}_0$</span>, we have to access the internal fields of the associated <code>system</code> of our vortexmodel.</p><pre><code class="language-julia hljs">f₀_list = []
for i in 1:length(bodies)
    Δs = dlength(bodies[i]);
    model = VortexModel(g,bodies=[bodies[i]]);
    ones = ScalarData(length(bodies[i]))
    ones .= 1.0
    f₀ = model.system.ibp.Sfact\ones
    push!(f₀_list,f₀)
end</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">┌ Warning: Assignment to `model` in soft scope is ambiguous because a global variable by the same name exists: `model` will be treated as a new local. Disambiguate by using `local model` to suppress this warning or `global model` to assign to the existing global variable.
└ @ 3.-Non-uniqueness-and-discrete-circulation.md:111</code></pre><p>Because the flat plate is an open body, we need to mirror and append its contents to itself to compare it to the ellipses. Furthermore, its bound vortex sheet strength should be divided by two because it represents <span>$\gamma = \gamma^{+} + \gamma^{-}$</span></p><pre><code class="language-julia hljs">append!(f₀_list[end],reverse!(f₀_list[end]));
Δs_plate = dlengthmid(bodies[end]);
append!(Δs_plate,reverse!(Δs_plate));
plot(ylim=(-2,0),xlabel=&quot;p/N&quot;,title=&quot;f₀ for ellipses of different aspect ratios&quot;)
for i in 1:length(bodies)-1
    plot!((1:length(f₀_list[i]))/length(f₀_list[i]),f₀_list[i]./dlength(bodies[i]),linecolor=colors[i],label=&quot;AR=$(AR_list[i])&quot;)
end
plot!((1:length(f₀_list[end]))/length(f₀_list[end]),0.5*f₀_list[end]./Δs_plate,linecolor=colors[end],label=&quot;AR=inf&quot;)</code></pre><img src="f92b7a71.svg" alt="Example block output"/><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../2.-Potential-flow-with-an-impenetrable-surface/">« 2. Potential flow with an impenetrable surface</a><a class="docs-footer-nextpage" href="../4.-The-Kutta-condition/">4. The Kutta condition »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.7.0 on <span class="colophon-date" title="Monday 23 September 2024 02:18">Monday 23 September 2024</span>. Using Julia version 1.10.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
