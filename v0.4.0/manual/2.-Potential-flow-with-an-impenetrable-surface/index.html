<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>2. Potential flow with an impenetrable surface · GridPotentialFlow.jl</title><meta name="title" content="2. Potential flow with an impenetrable surface · GridPotentialFlow.jl"/><meta property="og:title" content="2. Potential flow with an impenetrable surface · GridPotentialFlow.jl"/><meta property="twitter:title" content="2. Potential flow with an impenetrable surface · GridPotentialFlow.jl"/><meta name="description" content="Documentation for GridPotentialFlow.jl."/><meta property="og:description" content="Documentation for GridPotentialFlow.jl."/><meta property="twitter:description" content="Documentation for GridPotentialFlow.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">GridPotentialFlow.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../1.-Basic-potential-flow-problem/">1. Basic potential flow problem</a></li><li class="is-active"><a class="tocitem" href>2. Potential flow with an impenetrable surface</a><ul class="internal"><li><a class="tocitem" href="#Vortex-near-a-cylinder"><span>Vortex near a cylinder</span></a></li><li><a class="tocitem" href="#Moving-cylinder"><span>Moving cylinder</span></a></li></ul></li><li><a class="tocitem" href="../3.-Non-uniqueness-and-discrete-circulation/">3. Non-uniqueness and discrete circulation</a></li><li><a class="tocitem" href="../4.-The-Kutta-condition/">4. The Kutta condition</a></li><li><a class="tocitem" href="../5.-Generalized-edge-conditions/">5. Generalized edge conditions</a></li><li><a class="tocitem" href="../6.-Force-and-the-added-mass/">6. Force and the added mass</a></li></ul></li><li><span class="tocitem">Library</span><ul><li><a class="tocitem" href="../../public/">Public Documentation</a></li><li><a class="tocitem" href="../../private/">Private Documentation</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Manual</a></li><li class="is-active"><a href>2. Potential flow with an impenetrable surface</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>2. Potential flow with an impenetrable surface</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaIBPM/GridPotentialFlow.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaIBPM/GridPotentialFlow.jl/blob/master/test/literate/2.-Potential-flow-with-an-impenetrable-surface.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="2.-Potential-flow-with-an-impenetrable-surface"><a class="docs-heading-anchor" href="#2.-Potential-flow-with-an-impenetrable-surface">2. Potential flow with an impenetrable surface</a><a id="2.-Potential-flow-with-an-impenetrable-surface-1"></a><a class="docs-heading-anchor-permalink" href="#2.-Potential-flow-with-an-impenetrable-surface" title="Permalink"></a></h1><p>This part introduces the treatment of rigid impenetrable surfaces in <code>GridPotentialFlow</code>. We can impose the no-penetration constraint by setting the fluid streamfunction equal to that of the surface <span>$\mathfrak{s}_b$</span>, up to a uniform value <span>$s_0$</span>. The discrete no-penetration constraint is thus</p><p class="math-container">\[\mathsf{Es}=\mathfrak{s}_{b}-\mathsf{E} \mathsf{s}_{\infty}-\mathfrak{s}_{0},\]</p><p>where <span>$\mathsf{E}$</span> is the interpolation operator that interpolates grid data to the surface points, <span>$\mathsf{s}_{\infty}$</span> is the streamfunction of the uniform flow. For a body translating at velocity <span>$(U,V)$</span> and rotating at angular velocity <span>$\Omega$</span>, this streamfunction would be</p><p class="math-container">\[\mathfrak{s}_{b,k} = U \mathfrak{r}_y - V \mathfrak{r}_x - \frac{1}{2} \Omega (\mathfrak{r}_x^2+\mathfrak{r}_y^2).\]</p><p>For later shorthand, we will denote the difference between the body motion streamfunction and interpolated uniform flow streamfunction by <span>$\mathfrak{s}&#39;_b \equiv \mathfrak{s}_b - \mathsf{E} \mathsf{s}_{\infty}$</span>. The no-penetration constraint is enforced in the basic potential flow problem with the help of a vector of Lagrange multipliers, <span>$\mathfrak{f}$</span>, on the surface points. The modified potential flow problem is thus</p><p class="math-container">\[\mathsf{Ls} + \mathsf{R}\mathfrak{f} = -\mathsf{w},\]</p><p>where <span>$\mathsf{R}$</span> is the regularization operator that transfers data from surface data to nodes. <span>$\mathsf{E}$</span> can be constructed (and we will assume it has) so that it is the transpose of the interpolation operator, <span>$\mathsf{E} = \mathsf{R}^{T}$</span>.</p><p>From the previous equation, it is clear (by simple comparison with the vorticity on the right-hand side) that the vector <span>$\mathfrak{f}$</span> represents the strength of the discrete bound vortex sheet on the surface. Suppose we consider the bound vortex sheet <span>$\gamma(s)$</span> that emerges from the analogous continuous problem on the undiscretized surface, where <span>$s$</span> is the arc-length parameter along the surface. At each point <span>$p$</span>, the discrete solution <span>$\mathfrak{f}$</span> is approximately equal to this continuous solution, multiplied by the length <span>$\delta S_p$</span> of the small segment surrounding the point:</p><p class="math-container">\[\mathfrak{e}_{p}^{T} \mathfrak{f} \approx \gamma(s) \delta S_p.\]</p><p>Thus, the potential flow problem in the presence of the impenetrable surface is</p><p class="math-container">\[\begin{bmatrix}
\mathsf{L} &amp; \mathsf{R} \\
\mathsf{E} &amp;  0
\end{bmatrix} \begin{pmatrix} \mathsf{s} \\ \mathfrak{f} \end{pmatrix} =
\begin{pmatrix} -\mathsf{w} \\ \mathfrak{s}&#39;_b - \mathfrak{s}_0 \end{pmatrix}.\]</p><p>This problem has the structure of a generic saddle-point problem. <code>GridPotentialFlow.jl</code> automatically formulates the no-penetration constraint on the streamfunction and solves the saddle system when it needs to. See the next page for the role of <span>$\mathfrak{s}_0$</span> and how it will be treated internally.</p><p>We will now consider two examples. In these examples, we use the following grid.</p><pre><code class="language-julia hljs">Δx = 0.02
Lx = 4.0
xlim = (-Lx/2,Lx/2)
ylim = (-Lx/2,Lx/2)
g = PhysicalGrid(xlim,ylim,Δx);</code></pre><h2 id="Vortex-near-a-cylinder"><a class="docs-heading-anchor" href="#Vortex-near-a-cylinder">Vortex near a cylinder</a><a id="Vortex-near-a-cylinder-1"></a><a class="docs-heading-anchor-permalink" href="#Vortex-near-a-cylinder" title="Permalink"></a></h2><p>As a basic example, consider now a point vortex near a circular cylinder.</p><p>A body in <code>GridPotentialFlow.jl</code> is represented by <code>PotentialFlowBody</code>. This is a wrapper around a <code>Body</code> from <code>RigidBodyTools.jl</code> and can be endowed with a linear velocity, rotational velocity, circulation, and other properties using the appropriate keywords during construction or by mutating its fields using its setter methods. For our circular cylinder, we use the <code>Circle</code> shape.</p><pre><code class="language-julia hljs">Rc = Lx/4
Δs = 2Δx
body = PotentialFlowBody(Circle(Rc,Δs))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Potential flow body with 0 regularized edges
Shape and position: Circular body with 156 points and radius 1.0
   Current position: (0.0,0.0)
   Current angle (rad): 0.0
Linear velocity: (0.0, 0.0)
Angular velocity: 0.0
Current circulation: 0.0
</code></pre><p>We choose an initial position <span>$R_v$</span> of the vortex at <span>$3/2 R_c$</span> from the origin.</p><pre><code class="language-julia hljs">Rv = 3/2*Rc
Γv = 1.0
v = Vortex(Rv,0.0,Γv);</code></pre><p>And we set an equal and opposite circulation about the body</p><pre><code class="language-julia hljs">setΓ(body,-Γv)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">-1.0</code></pre><p>We construct the <code>VortexModel</code> by using the optional <code>bodies</code> keyword. In this case, we are interested in the bound vortex sheet strength <span>$\mathfrak{f}$</span>, instead of just the streamfunction field. For this reason, we use <code>solve</code>, which in this case returns a <code>ConstrainedIBPoissonSolution</code>.</p><pre><code class="language-julia hljs">model = VortexModel(g,vortices=[v],bodies=[body]);
sol = solve(model);</code></pre><p>We can then easily retrieve the streamfunction and the bound vortex sheet strength from the fields of the solution variable.</p><pre><code class="language-julia hljs">plot(sol.ψ,g)
plot!(body,fillcolor=:black,fillrange=0,fillalpha=0.25,linecolor=:black,linewidth=2)
scatter!([v.x],[v.y],color=:black,markersize=2,xlabel=&quot;x&quot;,ylabel=&quot;y&quot;)</code></pre><img src="34e925f7.svg" alt="Example block output"/><p>For this example, we can easily calculate the analytical bound vortex sheet strength <span>$\gamma$</span> and compare it with our numerical solution <span>$f$</span>. See the notebook in the examples folder for the analytical solution.</p><pre><code class="language-julia hljs">plot(sol.f./Δs,label=&quot;f/ds&quot;,xlabel=&quot;body point index&quot;)
plot!(γ,label=&quot;gamma&quot;)</code></pre><img src="a0ae95c1.svg" alt="Example block output"/><p>Finally, we can also check if the vortex will move around the cylinder on a circular path if we advance the system in time, as predicted by analytical potential flow theory. The period of the circular motion can be easily determined by calculating the velocity induced by the image vortex at <span>$R_c^2/R_v$</span>:</p><pre><code class="language-julia hljs">Vv = Γv/(2π*(Rv-Rc^2/Rv))
T = 2π*Rv/Vv</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">49.34802200544679</code></pre><p>For the time stepping, we again use the fourth-order Runge Kutta scheme from <code>OrdinaryDiffEq.jl</code>.</p><pre><code class="language-julia hljs">import OrdinaryDiffEq
function rhs(X,model,t)
    setvortexpositions!(model,X)
    Ẋ = vortexvelocities!(model)
    return Ẋ
end
X = getvortexpositions(model)
prob = OrdinaryDiffEq.ODEProblem(rhs,X,(0.0,T),model);
sol = OrdinaryDiffEq.solve(prob,dt=0.1,OrdinaryDiffEq.RK4(),dense=false,adaptive=false);
plot(body,fillcolor=:black,fillrange=0,fillalpha=0.25,linecolor=:black,linewidth=2)
plot!(map(s-&gt;s.u[1],sol.u),map(s-&gt;s.v[1],sol.u))
scatter!([v.x],[v.y],color=:black,markersize=2,xlabel=&quot;x&quot;,ylabel=&quot;y&quot;)</code></pre><img src="754374f3.svg" alt="Example block output"/><h2 id="Moving-cylinder"><a class="docs-heading-anchor" href="#Moving-cylinder">Moving cylinder</a><a id="Moving-cylinder-1"></a><a class="docs-heading-anchor-permalink" href="#Moving-cylinder" title="Permalink"></a></h2><p>In this example we will create a model with a moving body.</p><p>Here we use the keyword <code>U</code> to add create a body with a linear velocity.</p><pre><code class="language-julia hljs">body = PotentialFlowBody(Circle(Rc,Δs), U=(1.0,0.0))
model = VortexModel(g,bodies=[body]);
sol = solve(model);</code></pre><pre><code class="language-julia hljs">plot(sol.ψ,g)
plot!(body,fillcolor=:black,fillrange=0,fillalpha=0.25,linecolor=:black,linewidth=2,xlabel=&quot;x&quot;,ylabel=&quot;y&quot;)</code></pre><img src="0c123e3d.svg" alt="Example block output"/><p>Again, we can compare the discrete bound vortex sheet strength with the analytical vortex sheet strength.</p><pre><code class="language-julia hljs">plot(sol.f./Δs,label=&quot;f/ds&quot;,xlabel=&quot;body point index&quot;)
plot!(γ,label=&quot;gamma&quot;)</code></pre><img src="baf6df28.svg" alt="Example block output"/><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../1.-Basic-potential-flow-problem/">« 1. Basic potential flow problem</a><a class="docs-footer-nextpage" href="../3.-Non-uniqueness-and-discrete-circulation/">3. Non-uniqueness and discrete circulation »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.7.0 on <span class="colophon-date" title="Monday 23 September 2024 02:18">Monday 23 September 2024</span>. Using Julia version 1.10.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
